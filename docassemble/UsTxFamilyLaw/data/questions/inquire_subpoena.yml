---
include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.AssemblyLine:al_package.yml
---
objects:
  - subpoena: DAObject
  - subpoena.witness: ALIndividual
  - subpoena.witness.registered_agent: ALIndividual
  - subpoena.documents: DAList.using(object_type=DAObject, there_are_any=True)
  - subpoena.paralegal: ALIndividual
---
id: there is another
sets:
  - subpoena.documents.there_is_another
question: |
  <i class="fa-solid fa-circle-question" style="color: #74C0FC;"></i> You've listed ${subpoena.documents.number_gathered()} documents.
  
  Would you like to add another document?
yesno: subpoena.documents.there_is_another
---
id: get paralegal
sets:
  - subpoena.paralegal.name.first
question: |
  <i class="fa-solid fa-person-circle-question" style="color: #FFD43B;"></i> Paralegal supporting this subponea.
fields:
  - code: |
      subpoena.paralegal.name_fields() + subpoena.paralegal.gender_fields()
  - Email: subpoena.paralegal.email
    datatype: email
  - Telephone: subpoena.paralegal.telephone_number
---
id: get upload link
sets:
  - subpoena.secure_link
question: |
  <i class="fa-solid fa-file-shield" style="color: #74C0FC;"></i> Secure link for uploading documents for this subpoena.
fields:
  - Link: subpoena.secure_link
---
id: get subponea type
mandatory: True
sets:
  - subpoena.subpoena_type
question: |
  <i class="fa-solid fa-circle-question" style="color: #74C0FC;"></i> What type of subpoena are you issuing?
subquestion: |
  **Choose Subpoena**: When you just need the documents quickly and cheaply.
  
  **Choose Deposition**: When you need authentication or have complex document issues or are sending the subpoena out of state.

  See the HELP tab for additional help on this question.
fields:
  - Subpoena type: subpoena.subpoena_type
    choices:
      - Subpoena Duces Tecum: sdt
      - Deposition on Written Questions: dwq
help: |
  # Subpoea Type:
  
  **Subpoena Duces Tecum**
  
    ✓ Quick and cheap
  
    ✓ Requests business records affidavit
    
    ✓ Just gets documents
    
    ✓ 100-mile limit
    
    ✓ No court reporter needed
  
  **Deposition on Written Questions + Duces Tecum**
  
    ✓ Creates business records affidavit
    
    ✓ Can ask questions about documents - More than basic authentication details
    
    ✓ Works beyond 100 miles
    
    ✓ Requires court reporter
    
    ✓ More expensive
    
    ✓ Usually needed for out-of-state discovery
  
  **Choose Subpoena**: When you just need the documents quickly and cheaply.
  
  **Choose DWQ**: When you need authentication or have complex document issues or are sending the subponea out of state.
---
id: get witness
sets: 
  - subpoena.witness.name.first
question: |
  <i class="fa-solid fa-person-half-dress" style="color: #FFD43B;"></i> Who is the witness?
subquestion: |
  The witness is often "Custodian of Records"
fields:
  code: |
    subpoena.witness.name_fields(person_or_business="unsure") + subpoena.witness.mailing_address.address_fields(show_county=True, default_state="TX")
---
id: usps registered mail item number
sets:
  - subpoena.notice_usps_item_number
question: |
  <i class="fa-solid fa-envelope" style="color: #74C0FC;"></i> USPS Registered Mail Item Number for Notice to Witness
subquestion: |
  This is the 20-digit number from the U.S. Postal Service Certified Mail Receipt.
fields:
  - USPS CMRR Item number: subpoena.notice_usps_item_number
    
---
id: get registered agent
sets:
  - subpoena.witness.registered_agent.name.first
question: |
  <i class="fa-solid fa-person-half-dress" style="color: #FFD43B;"></i> ${subpoena.witness}'s Registered Agent
fields:
  - code: |
      subpoena.witness.registered_agent.name_fields(person_or_business="unsure") + subpoena.witness.registered_agent.mailing_address.address_fields()
---
id: get subpoena
sets:
  - subpoena.issue_date
  - subpoena.notice_date
  - subpoena.due_date
  - subpoena.is_bank_flag
question: |
  <i class="fa-solid fa-calendar-days" style="color: #74C0FC;"></i> About the subpoena.
fields:
  - Is the wittness a bank?: subpoena.bank_flag
    datatype: yesno
  - Is the witness CPS?: subpoena.cps_flag
    datatype: yesno
  - When will notice be served?: subpoena.notice_date
    datatype: date
  - When will the subpoena be issued?: subpoena.issue_date
    datatype: date
  - When will responses be due?: subpoena.due_date
    datatype: date
  - Beginning date of production: subpoena.beginning_production_date
    datatype: date
---
table: document_table
rows: subpoena.documents
columns:
  - Description: |
      row_item.description
edit:
  - description
delete: True
---
id: review documents
event: review_documents
question: |
  <i class="fa-solid fa-folder-tree" style="color: #74C0FC;"></i> Documents to be Produced
subquestion: |
  % if len(subpoena.documents):
  
  ${ document_table }
  
  ${ subpoena.documents.add_action() }
  % else:
  There are no documents yet.
  
  ${ subpoena.documents.add_action("Add a document") }
  % endif
action buttons:
  - label: Continue
    action: continue_subpoena
    color: info
    icon: circle-arrow-right
---
id: gather subpoena document
question: |
  <i class="fa-solid fa-folder-tree" style="color: #74C0FC;"></i> Describe the ${ ordinal(subpoena.documents.current_index()) } document to be produced.
fields:
  - Description: subpoena.documents[i].description
    required: True
---
